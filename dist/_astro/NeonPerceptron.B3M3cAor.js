const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/OrbitControls.majuGMpC.js","_astro/three.module.d0yTp6cH.js","_astro/Line2.BYFIb761.js","_astro/LineGeometry.Wo7Yi1SC.js","_astro/LineMaterial.PpmBEBWK.js"])))=>i.map(i=>d[i]);
import{r as dt,s as ft,a as ht}from"./attributes.BKVCFGue.js";import{x as mt,A as me,y as pt,c as Ne,m as Ge,l as vt,h as J,i as qe,_ as gt,o as wt,$ as Be,a0 as Et,L as ve,b as _t,a as xt,a1 as yt,r as Mt,a2 as bt,H as St,e as Dt,s as Lt,f as We,a3 as It,M as Tt,a4 as Pt,a5 as At,a6 as Ht,Y as Ot,a7 as ie,O as pe,P as Rt,S as kt,R as Nt,Q as X,T as re,U as $,d as C,Z as Gt,V as Fe,X as Ce,a8 as Ye}from"./render.Df3QsGvV.js";/* empty css                                                              */function Ze(v){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}class Wt{anchor;#t=new Map;#n=new Map;#e=new Map;#s=new Set;#o=!0;constructor(p,m=!0){this.anchor=p,this.#o=m}#i=p=>{if(this.#t.has(p)){var m=this.#t.get(p),s=this.#n.get(m);if(s)mt(s),this.#s.delete(m);else{var o=this.#e.get(m);o&&(this.#n.set(m,o.effect),this.#e.delete(m),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),s=o.effect)}for(const[i,n]of this.#t){if(this.#t.delete(i),i===p)break;const a=this.#e.get(n);a&&(me(a.effect),this.#e.delete(n))}for(const[i,n]of this.#n){if(i===m||this.#s.has(i))continue;const a=()=>{if(Array.from(this.#t.values()).includes(i)){var u=document.createDocumentFragment();gt(n,u),u.append(Ne()),this.#e.set(i,{effect:n,fragment:u})}else me(n);this.#s.delete(i),this.#n.delete(i)};this.#o||!s?(this.#s.add(i),pt(n,a,!1)):a()}}};#r=p=>{this.#t.delete(p);const m=Array.from(this.#t.values());for(const[s,o]of this.#e)m.includes(s)||(me(o.effect),this.#e.delete(s))};ensure(p,m){var s=vt,o=wt();if(m&&!this.#n.has(p)&&!this.#e.has(p))if(o){var i=document.createDocumentFragment(),n=Ne();i.append(n),this.#e.set(p,{effect:Ge(()=>m(n)),fragment:i})}else this.#n.set(p,Ge(()=>m(this.anchor)));if(this.#t.set(s,p),o){for(const[a,w]of this.#n)a===p?s.unskip_effect(w):s.skip_effect(w);for(const[a,w]of this.#e)a===p?s.unskip_effect(w.effect):s.skip_effect(w.effect);s.oncommit(this.#i),s.ondiscard(this.#r)}else J&&(this.anchor=qe),this.#i(s)}}function ze(v){Be===null&&Ze(),Et(()=>{const p=ve(v);if(typeof p=="function")return p})}function Ft(v){Be===null&&Ze(),ze(()=>()=>ve(v))}function Ct(v,p,m=!1){var s;J&&(s=qe,xt());var o=new Wt(v),i=m?yt:0;function n(a,w){if(J){var u=Mt(s),E;if(u===bt?E=0:u===St?E=!1:E=parseInt(u.substring(1)),a!==E){var _=Dt();Lt(_),o.anchor=_,We(!1),o.ensure(a,w),We(!0);return}}o.ensure(a,w)}_t(()=>{var a=!1;p((w,u=0)=>{a=!0,n(u,w)}),a||n(!1,null)},i)}const Ve=[...` 	
\r\fÂ \v\uFEFF`];function Vt(v,p,m){var s=""+v;if(m){for(var o of Object.keys(m))if(m[o])s=s?s+" "+o:o;else if(s.length)for(var i=o.length,n=0;(n=s.indexOf(o,n))>=0;){var a=n+i;(n===0||Ve.includes(s[n-1]))&&(a===s.length||Ve.includes(s[a]))?s=(n===0?"":s.substring(0,n))+s.substring(a+1):n=a}}return s===""?null:s}function jt(v,p,m,s,o,i){var n=v.__className;if(J||n!==m||n===void 0){var a=Vt(m,s,i);(!J||a!==v.getAttribute("class"))&&(a==null?v.removeAttribute("class"):v.className=a),v.__className=m}else if(i&&o!==i)for(var w in i){var u=!!i[w];(o==null||u!==!!o[w])&&v.classList.toggle(w,u)}return i}function je(v,p){return v===p||v?.[At]===p}function Ut(v={},p,m,s){return It(()=>{var o,i;return Tt(()=>{o=i,i=[],ve(()=>{v!==m(...i)&&(p(v,...i),o&&je(m(...o),v)&&p(null,...o))})}),()=>{Pt(()=>{i&&je(m(...i),v)&&p(null,...i)})}}),v}const qt="modulepreload",Bt=function(v){return"/"+v},Ue={},Q=function(p,m,s){let o=Promise.resolve();if(m&&m.length>0){let n=function(u){return Promise.all(u.map(E=>Promise.resolve(E).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),w=a?.nonce||a?.getAttribute("nonce");o=n(m.map(u=>{if(u=Bt(u),u in Ue)return;Ue[u]=!0;const E=u.endsWith(".css"),_=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${_}`))return;const d=document.createElement("link");if(d.rel=E?"stylesheet":qt,E||(d.as="script"),d.crossOrigin="",d.href=u,w&&d.setAttribute("nonce",w),document.head.appendChild(d),E)return new Promise((b,V)=>{d.addEventListener("load",b),d.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(n){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=n,window.dispatchEvent(a),!a.defaultPrevented)throw n}return o.then(n=>{for(const a of n||[])a.status==="rejected"&&i(a.reason);return p().catch(i)})};var Yt=Ye('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ox9ddm"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>'),Zt=Ye('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ox9ddm"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"></path></svg>'),zt=Nt('<div><div class="controls svelte-1ox9ddm"><button title="Clear the input grid" class="svelte-1ox9ddm">Reset</button> <button title="Generate new random weights" class="svelte-1ox9ddm">Randomise</button> <div class="slider-container svelte-1ox9ddm"><label class="svelte-1ox9ddm"> <input type="range" min="0.5" max="4.0" step="0.1" class="svelte-1ox9ddm"/></label></div></div> <button class="fullscreen-button svelte-1ox9ddm"><!></button></div>');function Jt(v,p){kt(p,!0);const m=[[1,1,1,1,1,1,0],[0,1,1,0,0,0,0],[1,1,0,1,1,0,1],[1,1,1,1,0,0,1],[0,1,1,0,0,1,1],[1,0,1,1,0,1,1],[1,0,1,1,1,1,1],[1,1,1,0,0,0,0],[1,1,1,1,1,1,1],[1,1,1,1,0,1,1]],s=25,o=9,i=10;let n,a=Ce(!1),w=Ce(2.2),u,E,_,d,b,V,I=[];const T={dense_0:[],dense_1:[]},ae={input:-4,hidden:0,output:4},x={input:[],hidden:[],output:[]},D={inputToHidden:[],hiddenToOutput:[]};let H,j,k=!1;function ge(){const e=Math.sqrt(2/(s+o)),l=Math.sqrt(2/(o+i));T.dense_0=Array.from({length:s*o},()=>(Math.random()*2-1)*e),T.dense_1=Array.from({length:o*i},()=>(Math.random()*2-1)*l)}function Xe(e,l,c=.4){const g=new e.Group,f=c*.7,t=c*1.1,r=c*.08,h=new e.Mesh(new e.BoxGeometry(f,t,r),new e.MeshStandardMaterial({color:657930,roughness:.8,metalness:.1}));h.position.z=-r/2,g.add(h);const y=new e.Mesh(new e.PlaneGeometry(f*.85,t*.9),new e.MeshStandardMaterial({color:1118481,roughness:.9,side:e.DoubleSide}));y.position.z=.001,g.add(y);const M=c*.28,L=c*.06,P=c*.38,N=M/2+L*.3,S=M/2,B=L/2,Oe=B*.7,A=new e.Shape;A.moveTo(-S+Oe,0),A.lineTo(-S,B),A.lineTo(S,B),A.lineTo(S+Oe,0),A.lineTo(S,-B),A.lineTo(-S,-B),A.closePath();const se=new e.ShapeGeometry(A),Y=se.clone();Y.rotateZ(Math.PI/2);const de=[{x:0,y:P,geom:se},{x:N,y:P/2,geom:Y},{x:N,y:-P/2,geom:Y},{x:0,y:-P,geom:se},{x:-N,y:-P/2,geom:Y},{x:-N,y:P/2,geom:Y},{x:0,y:0,geom:se}],Re=[],lt=m[l];for(let R=0;R<7;R++){const he=lt[R]===1,ut=new e.MeshStandardMaterial({color:he?16724736:1705984,emissive:16724736,emissiveIntensity:he?1:.02,roughness:.3,metalness:0,side:e.DoubleSide}),oe=new e.Mesh(de[R].geom.clone(),ut);oe.position.set(de[R].x,de[R].y,.01),oe.userData={segmentIndex:R,isOn:he},Re.push(oe),g.add(oe)}const G=f+c*.12,W=t+c*.12,ke=c*.06,O=new e.Shape;O.moveTo(-G/2,-W/2),O.lineTo(G/2,-W/2),O.lineTo(G/2,W/2),O.lineTo(-G/2,W/2),O.lineTo(-G/2,-W/2);const F=new e.Path,Z=G-ke*2,z=W-ke*2;F.moveTo(-Z/2,-z/2),F.lineTo(Z/2,-z/2),F.lineTo(Z/2,z/2),F.lineTo(-Z/2,z/2),F.lineTo(-Z/2,-z/2),O.holes.push(F);const fe=new e.Mesh(new e.ShapeGeometry(O),new e.MeshStandardMaterial({color:16716947,emissive:16716947,emissiveIntensity:0,transparent:!0,opacity:0,side:e.DoubleSide,roughness:.3,metalness:0}));return fe.position.z=.02,g.add(fe),g.userData={segments:Re,digit:l,halo:fe},g}async function $e(){if(!n)return;u=await Q(()=>import("./three.module.d0yTp6cH.js"),[]);const{OrbitControls:e}=await Q(async()=>{const{OrbitControls:t}=await import("./OrbitControls.majuGMpC.js");return{OrbitControls:t}},__vite__mapDeps([0,1])),{Line2:l}=await Q(async()=>{const{Line2:t}=await import("./Line2.BYFIb761.js");return{Line2:t}},__vite__mapDeps([2,1,3,4])),{LineMaterial:c}=await Q(async()=>{const{LineMaterial:t}=await import("./LineMaterial.PpmBEBWK.js");return{LineMaterial:t}},__vite__mapDeps([4,1])),{LineGeometry:g}=await Q(async()=>{const{LineGeometry:t}=await import("./LineGeometry.Wo7Yi1SC.js").then(r=>r.b);return{LineGeometry:t}},__vite__mapDeps([3,1]));E=new u.Scene,E.background=new u.Color(1118481),_=new u.PerspectiveCamera(60,n.clientWidth/n.clientHeight,.1,1e3),_.position.set(0,0,8),d=new u.WebGLRenderer({antialias:!0}),d.setSize(n.clientWidth,n.clientHeight),d.setPixelRatio(window.devicePixelRatio),n.append(d.domElement),b=new e(_,d.domElement),b.enableDamping=!0,b.dampingFactor=.05,E.add(new u.AmbientLight(16777215,.4));const f=new u.DirectionalLight(16777215,.8);f.position.set(5,5,5),E.add(f),H=new u.Raycaster,j=new u.Vector2,I=Array.from({length:s},()=>0),ge(),Qe(u),Je(u,l,c,g),d.domElement.addEventListener("mousedown",_e),d.domElement.addEventListener("mousemove",xe),d.domElement.addEventListener("mouseup",te),d.domElement.addEventListener("mouseleave",te),d.domElement.addEventListener("touchstart",ye,{passive:!1}),d.domElement.addEventListener("touchmove",Me,{passive:!1}),d.domElement.addEventListener("touchend",be),U(),Se()}function Qe(e){const c=new e.PlaneGeometry(.45,.45);for(let t=0;t<s;t++){const r=Math.floor(t/5),h=t%5,y=new e.MeshStandardMaterial({color:4491519,emissive:4491519,emissiveIntensity:0,side:e.DoubleSide}),M=new e.Mesh(c,y);M.position.set(ae.input,(2-r)*.5,(h-2)*.5),M.rotation.y=Math.PI/2,M.userData={layer:"input",index:t},E.add(M),x.input.push(M)}const g=new e.SphereGeometry(.15,16,16);for(let t=0;t<o;t++){const r=Math.floor(t/3),h=t%3,y=new e.MeshStandardMaterial({color:4521864,emissive:4521864,emissiveIntensity:.1}),M=new e.Mesh(g,y);M.position.set(ae.hidden,(1-r)*.6,(h-1)*.6),M.userData={layer:"hidden",index:t},E.add(M),x.hidden.push(M)}const f=1.2;for(let t=0;t<i;t++){const r=t/i*Math.PI*2-Math.PI/2,h=Xe(e,t,.35);h.position.set(ae.output,Math.sin(r)*f,Math.cos(r)*f),h.rotation.y=Math.PI/2,h.userData.layer="output",h.userData.index=t,E.add(h),x.output.push(h)}}function Je(e,l,c,g){const f=(t,r)=>{const h=new g;h.setPositions([t.x,t.y,t.z,r.x,r.y,r.z]);const y=new c({color:4473924,linewidth:2,transparent:!0,opacity:.3,resolution:new e.Vector2(window.innerWidth,window.innerHeight)});return new l(h,y)};for(let t=0;t<s;t++)for(let r=0;r<o;r++){const h=f(x.input[t].position,x.hidden[r].position);h.userData={fromLayer:"input",from:t,to:r},D.inputToHidden.push(h),E.add(h)}for(let t=0;t<o;t++)for(let r=0;r<i;r++){const h=f(x.hidden[t].position,x.output[r].position);h.userData={fromLayer:"hidden",from:t,to:r},D.hiddenToOutput.push(h),E.add(h)}}function we(e,l,c,g){const f=Array.from({length:g},()=>0);for(let t=0;t<g;t++)for(let r=0;r<c;r++)f[t]+=e[r]*l[r*g+t];return f}function Ke(e){const l=Math.max(...e),c=e.map(f=>Math.exp(f-l)),g=c.reduce((f,t)=>f+t,0);return c.map(f=>f/g)}function U(){if(!T.dense_0.length||!T.dense_1.length)return;const e=we(I,T.dense_0,s,o).map(Math.tanh),l=Ke(we(e,T.dense_1,o,i));et(I,e,l),tt(I,e)}function et(e,l,c){e.forEach((t,r)=>{x.input[r]&&(x.input[r].material.emissiveIntensity=t)}),l.forEach((t,r)=>{x.hidden[r]&&(x.hidden[r].material.emissiveIntensity=Math.abs(t)*.8)});const g=Math.max(...c),f=c.indexOf(g);c.forEach((t,r)=>{const h=x.output[r];if(!h?.userData.segments)return;const y=m[h.userData.digit];h.userData.segments.forEach((L,P)=>{const N=y[P]===1,S=L.material;N?(S.emissiveIntensity=.15+t*.85,S.color.setHex(t>.3?16724736:6689792)):(S.emissiveIntensity=.02,S.color.setHex(1705984))});const M=h.userData.halo;if(M){const L=M.material;r===f?(L.opacity=.8+g*.2,L.emissiveIntensity=1.5+g*.5,h.userData.isWinner=!0):(L.opacity=0,L.emissiveIntensity=0,h.userData.isWinner=!1)}})}function tt(e,l){const c=(f,t)=>{if(!f)return;const r=Math.min(Math.abs(t),2)/2,h=Math.pow(r,1/C(w)),y=f.material;Math.abs(t)<.001?(y.color.setHex(4473924),y.opacity=.05,y.linewidth=1):t>=0?(y.color.setHex(15113984),y.opacity=.1+h*.5,y.linewidth=1+h*4):(y.color.setHex(29362),y.opacity=.1+h*.5,y.linewidth=1+h*4)};let g=0;for(let f=0;f<s;f++)for(let t=0;t<o;t++)c(D.inputToHidden[g],I[f]*T.dense_0[f*o+t]),g++;g=0;for(let f=0;f<o;f++)for(let t=0;t<i;t++)c(D.hiddenToOutput[g],l[f]*T.dense_1[f*i+t]),g++}function K(e){if(!d)return;const l=d.domElement.getBoundingClientRect();j.x=(e.clientX-l.left)/l.width*2-1,j.y=-((e.clientY-l.top)/l.height)*2+1}function Ee(){return!H||!_?!1:(H.setFromCamera(j,_),H.intersectObjects(x.input).length>0)}function ee(){if(!H||!_)return;H.setFromCamera(j,_);const e=H.intersectObjects(x.input);if(e.length>0){const l=e[0].object.userData.index;I[l]=Math.min(1,I[l]+.15),U()}}function _e(e){K(e),Ee()&&(k=!0,b.enabled=!1,ee())}function xe(e){k&&(K(e),ee())}function te(){k=!1,b&&(b.enabled=!0)}function ye(e){e.touches.length===1&&(e.preventDefault(),K(e.touches[0]),Ee()&&(k=!0,b.enabled=!1,ee()))}function Me(e){k&&e.touches.length===1&&(e.preventDefault(),K(e.touches[0]),ee())}function be(){k=!1,b&&(b.enabled=!0)}function ce(){if(!n||!_||!d)return;_.aspect=n.clientWidth/n.clientHeight,_.updateProjectionMatrix(),d.setSize(n.clientWidth,n.clientHeight);const e=new u.Vector2(n.clientWidth,n.clientHeight);[...D.inputToHidden,...D.hiddenToOutput].forEach(l=>{const c=l?.material;c?.resolution&&c.resolution.copy(e)})}function Se(){V=requestAnimationFrame(Se),b&&b.update();const e=performance.now()*.003,l=.85+Math.sin(e)*.15;x.output.forEach(c=>{if(c.userData.isWinner&&c.userData.halo){const g=c.userData.halo.material;g.emissiveIntensity*=l}}),d&&E&&_&&d.render(E,_)}function nt(){I.fill(0),U()}function st(){ge(),U()}function ot(){n&&(document.fullscreenElement?document.exitFullscreen():n.requestFullscreen().catch(e=>console.error("Fullscreen failed:",e)))}function De(){Fe(a,!!document.fullscreenElement),setTimeout(ce,100)}function it(){V&&cancelAnimationFrame(V),d&&(d.domElement.removeEventListener("mousedown",_e),d.domElement.removeEventListener("mousemove",xe),d.domElement.removeEventListener("mouseup",te),d.domElement.removeEventListener("mouseleave",te),d.domElement.removeEventListener("touchstart",ye),d.domElement.removeEventListener("touchmove",Me),d.domElement.removeEventListener("touchend",be),d.dispose()),x.input.forEach(e=>{e.geometry.dispose(),e.material.dispose()}),x.hidden.forEach(e=>{e.geometry.dispose(),e.material.dispose()}),x.output.forEach(e=>{e.traverse(l=>{const c=l;c.geometry&&c.geometry.dispose(),c.material&&c.material.dispose()})}),D.inputToHidden.forEach(e=>{e.geometry.dispose(),e.material.dispose()}),D.hiddenToOutput.forEach(e=>{e.geometry.dispose(),e.material.dispose()}),x.input=[],x.hidden=[],x.output=[],D.inputToHidden=[],D.hiddenToOutput=[]}ze(()=>{$e(),window.addEventListener("resize",ce),document.addEventListener("fullscreenchange",De)}),Ft(()=>{window.removeEventListener("resize",ce),document.removeEventListener("fullscreenchange",De),it()});var q=zt();let Le;var le=X(q),Ie=X(le),Te=re(Ie,2),Pe=re(Te,2),Ae=X(Pe),He=X(Ae),ue=re(He);dt(ue),$(Ae),$(Pe),$(le);var ne=re(le,2),rt=X(ne);{var at=e=>{var l=Yt();pe(e,l)},ct=e=>{var l=Zt();pe(e,l)};Ct(rt,e=>{C(a)?e(ct,!1):e(at)})}$(ne),$(q),Ut(q,e=>n=e,()=>n),Ot(e=>{Le=jt(q,1,"neon-perceptron svelte-1ox9ddm",null,Le,{fullscreen:C(a)}),Gt(He,`Wire gamma: ${e??""} `),ft(ue,C(w)),ht(ne,"title",C(a)?"Exit fullscreen":"Enter fullscreen")},[()=>C(w).toFixed(1)]),ie("click",Ie,nt),ie("click",Te,st),ie("input",ue,e=>{Fe(w,Number.parseFloat(e.target.value),!0),U()}),ie("click",ne,ot),pe(v,q),Rt()}Ht(["click","input"]);export{Jt as default};
